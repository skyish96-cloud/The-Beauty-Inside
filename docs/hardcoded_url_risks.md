# 하드코딩된 URL의 위험성과 동적 해결

이 문서는 `frontend/src/js/config.js`에서 하드코딩된 `localhost:8000`을 동적 로직으로 변경하는 것이 왜 중요한지 설명합니다.

## 1. 문제점: 하드코딩된 `localhost:8000`

프론트엔드 코드를 다음과 같이 남겨두면:
```javascript
const host = "localhost:8000";
```

이는 백엔드 서버가 반드시 **접속자 본인의 컴퓨터(localhost) 8000번 포트**에서 실행 중이어야 한다는 강제 조건을 만듭니다.

### 위험 1: 배포 실패 (치명적)
프론트엔드를 공용 서버(AWS, Vercel, Netlify 등)에 배포했을 때:
- 사용자가 `https://your-app.com`에 접속합니다.
- 자바스크립트는 `ws://localhost:8000`으로 연결을 시도합니다.
- **결과**: 사용자의 컴퓨터(localhost)에는 백엔드 서버가 없으므로 연결이 실패합니다. 개발자 본인 외에는 아무도 앱을 사용할 수 없게 됩니다.

### 위험 2: 모바일 테스트 불가
같은 와이파이에 연결된 스마트폰으로 테스트하려 할 때:
- 폰에서 `http://192.168.0.x:5173`으로 접속합니다.
- 자바스크립트는 `ws://localhost:8000`으로 연결을 시도합니다.
- **결과**: 폰은 자기 자신(localhost)에서 백엔드를 찾으려다 실패합니다. PC에 있는 서버와 통신할 수 없습니다.

### 위험 3: 환경의 경직성
- 백엔드 포트를 변경하거나(예: 8080), 다른 개발 환경을 사용할 때마다 매번 소스 코드를 수동으로 수정해야 합니다.

## 2. 해결책: 동적 주소 결정 (Dynamic Resolution)

우리는 `config.js`를 다음과 같이 업데이트했습니다:
```javascript
// ... 개발 포트인지 확인하는 로직 ...
const host = isDev ? "localhost:8000" : location.host;
```

### 이점
1.  **로컬 작동**: 내 컴퓨터(`localhost:5173`)에서는 `localhost:8000`을 정확히 가리킵니다.
2.  **배포 작동**: 서버(`https://your-app.com`)에서는 자동으로 같은 도메인(`wss://your-app.com/ws/analyze`)을 가리킵니다.
3.  **모바일 작동 (일부)**: IP(`192.168.0.x`)로 접속 시, 해당 IP를 그대로 사용하여 PC와 정상적으로 통신할 수 있습니다.

이 변경으로 코드는 **환경에 구애받지 않고(Environment-agnostic)** 개발과 배포 환경 모두에서 동작하게 되었습니다.

## 3. 추가 수정 필요성 점검? (결론: 없음)

현재 `config.js` 수정만으로 충분하며, 다른 파일은 건드릴 필요가 없습니다.

### Frontend
- 다른 모든 파일(예: `ws_client.js`)은 이미 `config.js`의 설정을 가져다 쓰도록 설계되어 있습니다.
- 따라서 `config.js` 하나만 고치면 앱 전체에 자동으로 적용됩니다.

### Backend
- 백엔드 설정(`config.py`)은 현재 로컬 개발용(`localhost` 허용)으로 맞춰져 있어 바로 사용하시면 됩니다.
- **주의**: 나중에 실제 도메인(`https://...`)으로 배포할 때만 백엔드의 `cors_origins` 설정에 해당 주소를 추가해주시면 됩니다.
